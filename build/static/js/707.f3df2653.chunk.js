"use strict";(self.webpackChunkmockitupai=self.webpackChunkmockitupai||[]).push([[707],{707:(e,s,t)=>{t.r(s),t.d(s,{default:()=>c});var a=t(43),i=t(613),l=t(555),n=t(579);function r(){const{currentUser:e,userSubscription:s}=(0,i.A)(),[t,r]=(0,a.useState)(null),[c,d]=(0,a.useState)(!0),[o,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(null);(0,a.useEffect)((()=>{(async()=>{if(e)try{d(!0),u(null);const s=await fetch("/api/get-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.uid})}),t=await s.json();if(t.error)throw new Error(t.error);r(t.subscription)}catch(s){console.error("Error fetching subscription:",s),u("Failed to load subscription details. Please try again later.")}finally{d(!1)}})()}),[e]);return e?c?(0,n.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,n.jsx)("p",{className:"text-gray-500",children:"Loading subscription details..."})}):t&&"canceled"!==t.status&&"free"!==(null===s||void 0===s?void 0:s.tier)?(0,n.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subscription Management"}),h&&(0,n.jsx)("div",{className:"mb-4 bg-green-50 border border-green-200 text-green-800 rounded-md p-4 text-sm",children:h}),x&&(0,n.jsx)("div",{className:"mb-4 bg-red-50 border border-red-200 text-red-800 rounded-md p-4 text-sm",children:x}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Current Plan"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"pro"===(null===s||void 0===s?void 0:s.tier)?"Pro":"unlimited"===(null===s||void 0===s?void 0:s.tier)?"Unlimited":"Free"})]}),(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Status"}),(0,n.jsxs)("span",{className:"text-sm font-medium",children:["active"===t.status&&!t.cancelAtPeriodEnd&&(0,n.jsx)("span",{className:"text-green-600",children:"Active"}),"active"===t.status&&t.cancelAtPeriodEnd&&(0,n.jsx)("span",{className:"text-yellow-600",children:"Canceling"}),"active"!==t.status&&(0,n.jsx)("span",{className:"text-gray-600",children:t.status})]})]}),t.currentPeriodEnd&&(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:t.cancelAtPeriodEnd?"Access Until":"Next Billing Date"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-900",children:new Date(1e3*t.currentPeriodEnd).toLocaleDateString()})]}),t.paymentMethod&&(0,n.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"Payment Method"}),(0,n.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:[t.paymentMethod.brand," \u2022\u2022\u2022\u2022 ",t.paymentMethod.last4]})]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:["active"!==t.status||t.cancelAtPeriodEnd?"active"===t.status&&t.cancelAtPeriodEnd?(0,n.jsx)("p",{className:"text-sm text-gray-500 italic",children:"Your subscription will be canceled at the end of the current billing period."}):null:(0,n.jsx)("button",{onClick:async()=>{if(e&&t)try{m(!0),u(null);const s=await fetch("/api/cancel-subscription",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.uid,subscriptionId:t.id})}),a=await s.json();if(a.error)throw new Error(a.error);p("Your subscription has been canceled. You will have access until the end of your current billing period."),r((0,l.A)((0,l.A)({},t),{},{status:"canceled",cancelAtPeriodEnd:!0}))}catch(s){console.error("Error canceling subscription:",s),u("Failed to cancel subscription. Please try again later or contact support.")}finally{m(!1)}},disabled:o,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none",children:o?"Canceling...":"Cancel Subscription"}),(0,n.jsx)("button",{onClick:()=>window.location.href="#pricing",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none",children:"free"===(null===s||void 0===s?void 0:s.tier)?"Upgrade Plan":"Change Plan"})]})]}):(0,n.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subscription Management"}),(0,n.jsx)("p",{className:"text-gray-500 mb-4",children:"You don't have an active paid subscription."}),(0,n.jsx)("button",{onClick:()=>window.location.href="#pricing",className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none",children:"View Plans"})]}):(0,n.jsx)("div",{className:"bg-white shadow rounded-lg p-6",children:(0,n.jsx)("p",{className:"text-gray-500",children:"Please sign in to manage your subscription."})})}function c(e){let{onClose:s}=e;const{currentUser:t,logout:l}=(0,i.A)(),[c,d]=(0,a.useState)("profile");if(!t)return(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 overflow-y-auto h-full w-full z-50 flex justify-center items-center p-4",children:(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-3xl w-full p-6 text-center",children:[(0,n.jsx)("p",{children:"Please log in to view your dashboard."}),(0,n.jsx)("button",{onClick:s,className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"Close"})]})});return(0,n.jsx)("div",{className:"fixed inset-0 bg-gray-800 bg-opacity-75 overflow-y-auto h-full w-full z-50",children:(0,n.jsx)("div",{className:"flex justify-center items-start min-h-full p-4",children:(0,n.jsx)("div",{className:"bg-white rounded-xl shadow-2xl max-w-4xl w-full my-8 overflow-hidden",children:(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"User Dashboard"}),(0,n.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-gray-700","aria-label":"Close dashboard",children:(0,n.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,n.jsxs)("div",{className:"w-full md:w-1/3 space-y-4",children:[(0,n.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,n.jsx)("span",{className:"text-2xl text-blue-600",children:t.displayName?t.displayName.charAt(0).toUpperCase():"U"})}),(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t.displayName||"User"}),(0,n.jsx)("p",{className:"text-sm text-gray-500",children:t.email})]})}),(0,n.jsxs)("nav",{className:"space-y-1",children:[["profile","subscription"].map((e=>(0,n.jsx)("button",{onClick:()=>d(e),className:"w-full text-left px-4 py-2 rounded-md ".concat(c===e?"bg-blue-50 text-blue-700 font-medium":"text-gray-700 hover:bg-gray-100"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))),(0,n.jsx)("button",{onClick:async()=>{try{await l(),s&&s()}catch(e){console.error("Logout failed:",e)}},className:"w-full text-left px-4 py-2 rounded-md text-gray-700 hover:bg-gray-100",children:"Logout"})]})]}),(0,n.jsxs)("div",{className:"flex-1",children:["profile"===c&&(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Profile Information"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:t.displayName||"Not set"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-900",children:t.email})]})]})]}),"subscription"===c&&(0,n.jsx)(r,{})]})]})]})})})})}}}]);
//# sourceMappingURL=707.f3df2653.chunk.js.map